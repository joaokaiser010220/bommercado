<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üê∏ Sapich√µes Quiz</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap');
body { margin:0; font-family:'Fredoka One', sans-serif; background:#dfffd6; color:#2e7d32; text-align:center; }
header { background:#66bb6a; color:white; padding:15px; font-size:28px; font-weight:bold; }
button { padding:12px 25px; margin:10px; border:none; border-radius:10px; background:#43a047; color:white; font-size:18px; cursor:pointer; }
button:hover { background:#2e7d32; }
input, select { padding:10px; margin:5px; border-radius:8px; font-size:16px; }
#telaInicial, #hostTela, #playerTela, #perguntaArea, #ranking { margin-top:20px; }
#ranking p { font-size:20px; font-weight:bold; }
.medalha { font-size:28px; margin-right:10px; }
#timer { font-size:24px; color:#ff6f00; font-weight:bold; }
@media(max-width:600px){ button,input,select{width:80%; font-size:16px;} header{font-size:24px;} #timer{font-size:20px;} }
</style>
</head>
<body>

<header>üê∏ Sapich√µes Quiz</header>

<div id="telaInicial">
  <button onclick="mostrarTela('host')">Criar Jogo</button>
  <button onclick="mostrarTela('player')">Entrar no Jogo</button>
</div>

<div id="hostTela" style="display:none">
  <h2>Escolha a categoria:</h2>
  <select id="categoria"></select><br>
  <button onclick="criarJogo()">Criar Partida</button>
  <p id="pin"></p>
  <div id="lobby"></div>
  <button onclick="iniciarJogo()">Iniciar Jogo</button>
</div>

<div id="playerTela" style="display:none">
  <div id="pinDiv">
    <input type="number" id="pinInput" placeholder="PIN da partida"><br>
  </div>
  <input type="text" id="nome" placeholder="Seu nome"><br>
  <button onclick="entrar()">Entrar</button>
  <div id="perguntaArea" style="display:none">
    <div id="pergunta"></div>
    <div id="opcoes"></div>
    <div id="timer"></div>
  </div>
</div>

<div id="ranking" style="display:none"></div>

<script>
// Perguntas internas
const perguntas = {
  "matematica":[
    {pergunta:"Quanto √© 7 x 8?", opcoes:["54","56","64","48"], correta:1},
    {pergunta:"Raiz quadrada de 81?", opcoes:["7","8","9","10"], correta:2}
  ],
  "portugues":[
    {pergunta:"Plural de 'c√£o'?", opcoes:["c√µes","c√£os","c√£es","caos"], correta:2}
  ],
  "historia":[
    {pergunta:"Ano da Independ√™ncia do Brasil?", opcoes:["1822","1889","1500","1808"], correta:0}
  ],
  "geografia":[
    {pergunta:"Maior pa√≠s do mundo?", opcoes:["China","R√∫ssia","Brasil","Canad√°"], correta:1}
  ]
};

// Vari√°veis do host
let pinGerado, categoriaEscolhida, jogadores = {}, perguntaIndex=0, timerInterval, tempo=15;

// Tela inicial
function mostrarTela(tela){
  document.getElementById("telaInicial").style.display="none";
  document.getElementById("hostTela").style.display = (tela==='host') ? "block" : "none";
  document.getElementById("playerTela").style.display = (tela==='player') ? "block" : "none";
  if(tela==='host'){
    const select = document.getElementById("categoria");
    select.innerHTML="";
    Object.keys(perguntas).forEach(cat=>{
      const option = document.createElement("option");
      option.value=cat;
      option.textContent=cat.charAt(0).toUpperCase()+cat.slice(1);
      select.appendChild(option);
    });
  }
}

// Criar jogo
function criarJogo(){
  categoriaEscolhida = document.getElementById("categoria").value;
  pinGerado = Math.floor(100000 + Math.random()*900000);
  document.getElementById("pin").innerText = "PIN: "+pinGerado;
  jogadores = {};
  atualizarLobby();
}

// Atualizar lobby
function atualizarLobby(){
  const div = document.getElementById("lobby");
  div.innerHTML="<h3>Jogadores no lobby:</h3>";
  for(let j in jogadores){
    div.innerHTML += "<p>"+j+"</p>";
  }
}

// Iniciar jogo
function iniciarJogo(){
  if(Object.keys(jogadores).length===0){ alert("Nenhum jogador no lobby!"); return; }
  perguntaIndex=0;
  mostrarPerguntaHost();
}

// Mostrar pergunta host
function mostrarPerguntaHost(){
  if(perguntaIndex>=perguntas[categoriaEscolhida].length){ mostrarRankingFinal(); return; }
  tempo=15;
  const p = perguntas[categoriaEscolhida][perguntaIndex];
  document.getElementById("pergunta").innerText = p.pergunta;
  const divO = document.getElementById("opcoes");
  divO.innerHTML="";
  p.opcoes.forEach((op,i)=>{
    const btn = document.createElement("button");
    btn.innerText=op;
    btn.onclick = ()=>responder(i);
    divO.appendChild(btn);
  });
  document.getElementById("perguntaArea").style.display="block";
  atualizarTimer();
}

// Timer
function atualizarTimer(){
  document.getElementById("timer").innerText = "‚è± "+tempo+"s";
  timerInterval = setInterval(()=>{
    tempo--;
    document.getElementById("timer").innerText = "‚è± "+tempo+"s";
    if(tempo<=0){ clearInterval(timerInterval); perguntaIndex++; mostrarPerguntaHost(); }
  },1000);
}

// Responder
function responder(opIndex){
  clearInterval(timerInterval);
  const p = perguntas[categoriaEscolhida][perguntaIndex];
  if(opIndex===p.correta){
    for(let j in jogadores) jogadores[j]+=10 + tempo; // pontos + bonus por rapidez
  }
  perguntaIndex++;
  mostrarPerguntaHost();
}

// Player
let nome="", pin="", pontos=0;
function entrar(){
  pin = document.getElementById("pinInput").value;
  nome = document.getElementById("nome").value;
  if(!nome){ alert("Digite seu nome!"); return; }
  jogadores[nome]=0;
  atualizarLobby();
  document.getElementById("pinDiv").style.display="none";
  document.getElementById("playerTela").querySelector("button").style.display="none";
  mostrarPerguntaHost();
}

// Ranking final
function mostrarRankingFinal(){
  document.getElementById("perguntaArea").style.display="none";
  document.getElementById("hostTela").style.display="none";
  document.getElementById("playerTela").style.display="none";
  const divR = document.getElementById("ranking");
  divR.style.display="block";
  divR.innerHTML="<h2>üèÜ Ranking Final üèÜ</h2>";
  const lista = [];
  for(let j in jogadores){
    lista.push({nome:j, score:jogadores[j]});
  }
  lista.sort((a,b)=>b.score-a.score);
  lista.forEach((p,i)=>{
    let medalha="";
    if(i===0) medalha="ü•á";
    else if(i===1) medalha="ü•à";
    else if(i===2) medalha="ü•â";
    divR.innerHTML+="<p><span class='medalha'>"+medalha+"</span>"+p.nome+" - "+p.score+" pts</p>";
  });
}
</script>
</body>
</html>
